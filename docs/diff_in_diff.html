<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Dise√±os experimentales y cuasiexperimentales - 7&nbsp; Diferencias en diferencias</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./reg_discontinua.html" rel="next">
<link href="./matching.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "S√≠n resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la busqueda",
    "search-hide-matches-text": "Esconder resultados adicionales",
    "search-more-match-text": "hay m√°s resultados en este documento",
    "search-more-matches-text": "m√°s resultados en este documento",
    "search-clear-button-title": "Borrar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Eviar"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Diferencias en diferencias</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Dise√±os experimentales y cuasiexperimentales</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle sidebar-tool" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Prefacio</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_R.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">R y el tidyverse</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_stat.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Repaso de probabilidad y estad√≠stica</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./potential_outcomes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title"><em>Potential outcomes</em></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dags.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Grafos ac√≠clicos dirigidos (DAGS)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exp_aleatorios.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Experimentos aleatorios</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./matching.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Subclasificaci√≥n y <em>matching</em></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./diff_in_diff.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Diferencias en diferencias</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reg_discontinua.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Regresi√≥n discontinua</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./var_instrumentales.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Variables instrumentales</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">Referencias</a>
  </div>
</li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">√çndice</h2>
   
  <ul>
  <li><a href="#barcos-naranjas-y-chocolates" id="toc-barcos-naranjas-y-chocolates" class="nav-link active" data-scroll-target="#barcos-naranjas-y-chocolates"><span class="toc-section-number">7.1</span>  Barcos, naranjas y chocolates üçä</a></li>
  <li><a href="#de-las-naranjas-a-las-diferencias-en-diferencias" id="toc-de-las-naranjas-a-las-diferencias-en-diferencias" class="nav-link" data-scroll-target="#de-las-naranjas-a-las-diferencias-en-diferencias"><span class="toc-section-number">7.2</span>  De las naranjas a las diferencias en diferencias</a>
  <ul class="collapse">
  <li><a href="#enfoque-1-comparar-post-intervenci√≥n-entre-grupos" id="toc-enfoque-1-comparar-post-intervenci√≥n-entre-grupos" class="nav-link" data-scroll-target="#enfoque-1-comparar-post-intervenci√≥n-entre-grupos"><span class="toc-section-number">7.2.1</span>  Enfoque 1: Comparar post-intervenci√≥n entre grupos</a></li>
  <li><a href="#enfoque-2-comparar-el-barco-pre-y-post-intervenci√≥n" id="toc-enfoque-2-comparar-el-barco-pre-y-post-intervenci√≥n" class="nav-link" data-scroll-target="#enfoque-2-comparar-el-barco-pre-y-post-intervenci√≥n"><span class="toc-section-number">7.2.2</span>  Enfoque 2: Comparar el barco pre y post-intervenci√≥n</a></li>
  <li><a href="#enfoque-3-diferencia-en-diferencias-did" id="toc-enfoque-3-diferencia-en-diferencias-did" class="nav-link" data-scroll-target="#enfoque-3-diferencia-en-diferencias-did"><span class="toc-section-number">7.2.3</span>  Enfoque 3: Diferencia en diferencias (DiD)</a></li>
  </ul></li>
  <li><a href="#definicion-formal-de-diferencias-en-diferencias" id="toc-definicion-formal-de-diferencias-en-diferencias" class="nav-link" data-scroll-target="#definicion-formal-de-diferencias-en-diferencias"><span class="toc-section-number">7.3</span>  Definicion formal de Diferencias en diferencias</a></li>
  <li><a href="#el-supuesto-de-las-tendencias-paralelas" id="toc-el-supuesto-de-las-tendencias-paralelas" class="nav-link" data-scroll-target="#el-supuesto-de-las-tendencias-paralelas"><span class="toc-section-number">7.4</span>  El supuesto de las tendencias paralelas</a>
  <ul class="collapse">
  <li><a href="#evidencia-a-favor-del-supuesto-de-pendientes-paralelas" id="toc-evidencia-a-favor-del-supuesto-de-pendientes-paralelas" class="nav-link" data-scroll-target="#evidencia-a-favor-del-supuesto-de-pendientes-paralelas"><span class="toc-section-number">7.4.1</span>  Evidencia a favor del supuesto de pendientes paralelas</a></li>
  </ul></li>
  <li><a href="#la-importancia-delplacebo" id="toc-la-importancia-delplacebo" class="nav-link" data-scroll-target="#la-importancia-delplacebo"><span class="toc-section-number">7.5</span>  La importancia delplacebo</a></li>
  </ul>
</nav>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-did" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Diferencias en diferencias</span></span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<div class="cell">

</div>
<p>En esta seccion vamos a hablar de uno de los dise√±os quasiexperimentales m√°s populares. Este tipo de dise√±o, si bien ha sido definido formalmente en tiempos mas modernos, ha existido en formas rudimentaria como una aproximacion intuitiva en las investigaciones observacionales que se han hecho en los ultimos 300 a√±os.</p>
<p>Debido a su caracter tan intuitivo vamos a tratar de arrimarnos a su concepcion a trav√©s de un enfoque historico.</p>
<section id="barcos-naranjas-y-chocolates" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="barcos-naranjas-y-chocolates"><span class="header-section-number">7.1</span> Barcos, naranjas y chocolates üçä</h2>
<p>Entre los siglos XVI y XVII, la humanidad vivi√≥ una transformaci√≥n social sin precedentes. Tras la era de los grandes navegantes, la sociedad occidental se expandi√≥ por todo el globo, estableciendo rutas comerciales que circunnavegaban la Tierra con frecuencia, sin necesidad de tocar puerto. Estas rutas conectaban Europa con la India, China y Am√©rica en un flujo constante de tr√°fico mar√≠timo, aunque cada viaje pod√≠a durar varios meses.</p>
<p>Con esta expansi√≥n surgi√≥ tambi√©n una enfermedad devastadora: la llamada ‚Äúmelancol√≠a del mar‚Äù. Una proporci√≥n significativa de marineros, especialmente en los viajes m√°s largos, comenzaba a experimentar una fatiga creciente, aparici√≥n de manchas √°speras en la piel, √∫lceras en las enc√≠as, p√©rdida de dientes e incluso la muerte, que pod√≠a ocurrir pocas semanas despu√©s de los primeros s√≠ntomas. Esta enfermedad pas√≥ a conocerse como <em>escorbuto</em>, nombre derivado de una palabra escandinava que hac√≠a referencia a las √∫lceras en el paladar.</p>
<p>El escorbuto se convirti√≥ en un problema grave de salud, y tambi√©n econ√≥mico: en cada traves√≠a hacia la India, por ejemplo, hasta un 10 % de la tripulaci√≥n pod√≠a morir o quedar gravemente afectada por la enfermedad.</p>
<p>Dispuesto a resolver el problema el Dr James Lind (sin t al final que esos son los chocolates, y esa es la unica mencion a los chocolates) en 1747 se dio cuenta que todos los que opinaban sobre la enfermedad nunca se habian subido a un barco, decidido que la unica alternativa era la observacion del fenomeno se subio a un barco de Liverpool a la India, se agarro escorbuto y llego a la idea de que toda la tripulacion tenia mayor o menormente los sintomas, pero algunos marineros parecian estar significativamente mejor, eran los que habian traido desde sus casas alguna conservas o licores caseros (fundamentalmente de frutas).</p>
<p>Con esta observaci√≥n, Lind propuso un dise√±o cuasi-experimental para investigar el escorbuto. Aunque los datos originales se han perdido con el tiempo, podemos imaginar c√≥mo pudo haber sido el experimento. Lind plante√≥ comparar dos barcos ‚Äîel Marigold y el Endeavour‚Äî que zarpar√≠an desde Liverpool rumbo a la India, llevando productos textiles y regresando con materias primas. La diferencia clave: durante el viaje de regreso, solo la tripulaci√≥n del Marigold recibir√≠a una naranja diaria. En cada uno de los cuatro viajes, se registrar√≠an los casos de escorbuto, resultando en una tabla como la siguiente:</p>
<table class="table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Barco</th>
<th>Casos (Liverpool‚ÄìIndia)</th>
<th>Marineros (Liverpool‚ÄìIndia)</th>
<th>Casos (India‚ÄìLiverpool)</th>
<th>Marineros (India‚ÄìLiverpool)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Marigold</td>
<td>72</td>
<td>180</td>
<td>18</td>
<td>200</td>
</tr>
<tr class="even">
<td>Endeavour</td>
<td>60</td>
<td>180</td>
<td>50</td>
<td>150</td>
</tr>
</tbody>
</table>
<blockquote class="blockquote">
<p><strong>Spoiler alert</strong> Lind descubrio que el escorbuto se deb√≠a a un factor nutricional desconocido presente en frutas y vegetales frescos y en sus derivados. M√°s tarde sabriamos que es la vitamina C.</p>
</blockquote>
</section>
<section id="de-las-naranjas-a-las-diferencias-en-diferencias" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="de-las-naranjas-a-las-diferencias-en-diferencias"><span class="header-section-number">7.2</span> De las naranjas a las diferencias en diferencias</h2>
<p>Lind parece tener todo listo para demostrar el efecto de su tratamiento: las naranjas. La primera tentaci√≥n ser√≠a comparar directamente los casos de escorbuto en el viaje de regreso, de India a Liverpool, entre los dos barcos: el Marigold (grupo tratado) y el Endeavour (grupo control). La otra posibilidad ser√≠a comparar los casos del Marigold al ir a la India (control), y al volver con naranjas (tratamiento). Vamos a analizar cada enfoque</p>
<section id="enfoque-1-comparar-post-intervenci√≥n-entre-grupos" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="enfoque-1-comparar-post-intervenci√≥n-entre-grupos"><span class="header-section-number">7.2.1</span> Enfoque 1: Comparar post-intervenci√≥n entre grupos</h3>
<p>Este enfoque suena sencillo y, adem√°s, bastante l√≥gico: hay un tratamiento claro (las naranjas) y un grupo que no lo recibi√≥. La comparaci√≥n directa entre los casos de escorbuto en el viaje de regreso (<em>India‚ÄìLiverpool</em>) entre el <em>Marigold</em> (grupo tratado) y el <em>Endeavour</em> (grupo control) parece una forma intuitiva de evaluar el efecto.</p>
<p>Pero si ven√≠s siguiendo este libro con atenci√≥n, probablemente ya se te prendieron algunas alarmas. Y si no lo hiciste todav√≠a, dejame se√±alar una advertencia clave ‚Äîque vale la pena destacar:</p>
<blockquote class="blockquote">
<p><strong>‚ö†Ô∏è La utilizaci√≥n del <em>SDO</em> (Simple Difference of Outcomes) como estimador del <em>ATE</em> (Average Treatment Effect) solo es v√°lida si la asignaci√≥n a los grupos fue aleatoria.</strong></p>
</blockquote>
<p>En este caso, formar parte de la tripulaci√≥n del <em>Marigold</em> o del <em>Endeavour</em> no fue una decisi√≥n aleatoria. Y eso es un problema. Hay muchas razones ‚Äîalgunas conocidas, otras ocultas‚Äî por las que los marineros de un barco podr√≠an diferir sistem√°ticamente de los del otro. Por ejemplo, quiz√°s un capit√°n recluta tripulaci√≥n en una regi√≥n donde los marineros suelen llevar licores o frutas fermentadas que podr√≠an, sin quererlo, ofrecer protecci√≥n contra el escorbuto. El otro capit√°n no.</p>
<p>Eso significa que pertenecer a uno u otro barco no solo influye en la probabilidad de recibir el tratamiento (las naranjas), sino que tambi√©n puede afectar directamente el resultado (los casos de escorbuto). En otras palabras: hay un <strong>efecto fijo</strong> ligado a cada barco que no estamos controlando, y eso debilita el valor contrafactual de la comparaci√≥n entre grupos.</p>
<p>Para entender mejor este problema, tratemos de formalizarlo un poco.</p>
<p>Supongamos que cada barco tiene un efecto propio, constante, sobre el n√∫mero de casos de escorbuto. Es decir, m√°s all√° del tratamiento, hay algo estructural ‚Äîel barco en s√≠‚Äî que influye en los resultados: el liderazgo del capit√°n, la experiencia de los marineros, las condiciones sanitarias a bordo, etc.</p>
<p>Estos <strong>efectos fijos</strong> act√∫an como una especie de ‚Äúfirma‚Äù del barco sobre el resultado. Por eso, aunque a uno le demos naranjas y al otro no, no podemos estar completamente seguros de que las diferencias en los casos se deban al tratamiento.</p>
<p>Para ordenar las ideas, usemos un poco de notaci√≥n:</p>
<ul>
<li><strong>Y</strong>: n√∫mero de casos de escorbuto<br>
</li>
<li><strong>D</strong>: tratamiento (naranjas: s√≠ o no)<br>
</li>
<li><em>M</em> y <em>E</em>: efectos fijos del <em>Marigold</em> y <em>Endeavour</em>, respectivamente</li>
</ul>
<p>Entonces podemos representar los casos de escorbuto as√≠:</p>
<table class="table">
<thead>
<tr class="header">
<th>Barco</th>
<th>Casos (Viaje de regreso)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Marigold</td>
<td><strong>Y</strong> = <strong>D</strong> + <em>M</em></td>
</tr>
<tr class="even">
<td>Endeavour</td>
<td><strong>Y</strong> = <em>E</em></td>
</tr>
</tbody>
</table>
<p>En este modelo, si simplemente restamos los casos entre grupos post-tratamiento (como har√≠amos con un <em>SDO</em>), obtenemos:</p>
<p>$ Y_{} - Y_{} = D + (M - E) $</p>
<p>Aqu√≠ aparece un problema clave: el t√©rmino ( M - E ) representa una diferencia estructural entre barcos ‚Äîy puede interpretarse como un <strong>sesgo de selecci√≥n</strong>.</p>
<div class="callout callout callout-style-simple no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Si nos queda dudas de si esto es el sesgo de seleccion, podemos redefinir los efectos fijos en t√©rminos de resultados potenciales as√≠:</p>
<ul>
<li>$ M = Y_1^M - Y_0^M $: diferencia entre el resultado del <em>Marigold</em> con tratamiento y sin tratamiento<br>
</li>
<li>$ E = Y_0^E $: resultado potencial del <em>Endeavour</em> sin tratamiento</li>
</ul>
<p>Entonces, el resultado observado del <em>Marigold</em> puede escribirse como:</p>
<p><span class="math display">\[
Y_{\text{Marigold}} = Y_1^M = Y_0^M + D
\]</span></p>
<p>Y el resultado del <em>Endeavour</em>, al no recibir tratamiento, es:</p>
<p><span class="math display">\[
Y_{\text{Endeavour}} = Y_0^E
\]</span></p>
<p>Por lo tanto, la diferencia observada entre barcos es:</p>
<p><span class="math display">\[
Y_1^M - Y_0^E = (Y_0^M + N) - Y_0^E = D + (Y_0^M - Y_0^E)
\]</span></p>
<p>El t√©rmino $ Y_0^M - Y_0^E $ es exactamente el <strong>sesgo de selecci√≥n</strong>: la diferencia preexistente entre los grupos en ausencia de tratamiento. Si este valor no es cero, el estimador SDO estar√° sesgado.</p>
</div>
</div>
</div>
</section>
<section id="enfoque-2-comparar-el-barco-pre-y-post-intervenci√≥n" class="level3" data-number="7.2.2">
<h3 data-number="7.2.2" class="anchored" data-anchor-id="enfoque-2-comparar-el-barco-pre-y-post-intervenci√≥n"><span class="header-section-number">7.2.2</span> Enfoque 2: Comparar el barco pre y post-intervenci√≥n</h3>
<p>En el enfoque anterior vimos que no podemos simplemente comparar dos unidades diferentes (como barcos) porque existe el riesgo de sesgo de selecci√≥n. Pero, entonces, ¬øpodemos comparar una unidad consigo misma antes y despu√©s del tratamiento?</p>
<p>Esta idea es intuitiva y tiene nombre: se trata de una <strong>serie de tiempo interrumpida</strong>. En este caso, comparar√≠amos al <em>Marigold</em> antes y despu√©s de recibir naranjas. Veamos una tabla simplificada:</p>
<table class="table">
<thead>
<tr class="header">
<th>Barco</th>
<th>Viaje (<em>t</em>)</th>
<th>Casos</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Marigold</td>
<td>Ida (sin tratamiento)</td>
<td>Y = M</td>
</tr>
<tr class="even">
<td>Marigold</td>
<td>Regreso (con tratamiento)</td>
<td>Y = M + (t + D)</td>
</tr>
</tbody>
</table>
<p>Este enfoque tiene una ventaja: al comparar la unidad consigo misma, el <strong>efecto fijo del barco</strong> queda eliminado. Ya no tenemos el problema de las diferencias estructurales entre barcos. Pero ahora aparece otro problema.</p>
<p>Aunque este procedimiento elimina con √©xito el sesgo asociado a diferencias entre barcos, <strong>no nos da una estimaci√≥n no sesgada del efecto del tratamiento</strong>. ¬øPor qu√©? Porque el estimador basado en la <strong>Simple Difference of Outcomes (SDO)</strong> no puede corregir los <strong>cambios naturales a lo largo del tiempo</strong>.</p>
<p>En otras palabras, el n√∫mero de casos puede cambiar simplemente porque el viaje de regreso fue diferente, porque hubo una nueva ola de escorbuto, o por cualquier otro factor relacionado con el tiempo. A esto lo representamos con el t√©rmino ( t ) en la f√≥rmula.</p>
<p>Entonces, aunque ya no estamos comparando peras con manzanas (barcos distintos), ahora estamos asumiendo err√≥neamente que el contexto temporal antes y despu√©s del tratamiento es equivalente, lo cual tampoco es cierto. Por eso, <strong>tampoco podemos confiar en esta comparaci√≥n para estimar el efecto real del tratamiento</strong>.</p>
</section>
<section id="enfoque-3-diferencia-en-diferencias-did" class="level3" data-number="7.2.3">
<h3 data-number="7.2.3" class="anchored" data-anchor-id="enfoque-3-diferencia-en-diferencias-did"><span class="header-section-number">7.2.3</span> Enfoque 3: Diferencia en diferencias (DiD)</h3>
<p>Reci√©n vimos que:</p>
<ul>
<li>Comparar un barco con otro introduce un <strong>sesgo de selecci√≥n</strong>, porque no fueron asignados aleatoriamente.</li>
<li>Comparar un barco consigo mismo antes y despu√©s elimina ese sesgo, pero introduce una <strong>variable confundidora no medida</strong>: el tiempo.</li>
</ul>
<p>La intuici√≥n detr√°s de la estrategia de <strong>diferencia en diferencias (DiD)</strong> es sorprendentemente simple: combinar ambos enfoques b√°sicos de forma que, por turnos, se eliminen tanto el sesgo de selecci√≥n como el efecto del tiempo.</p>
<p>Ve√°moslo en la siguiente tabla:</p>
<table class="table">
<thead>
<tr class="header">
<th>Barco</th>
<th>Viaje (<em>t</em>)</th>
<th>Tratamiento (N)</th>
<th>Casos</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Marigold</td>
<td>Ida (pre)</td>
<td>No</td>
<td>Y = M</td>
</tr>
<tr class="even">
<td>Marigold</td>
<td>Regreso (post)</td>
<td>S√≠</td>
<td>Y = M + D + t</td>
</tr>
<tr class="odd">
<td>Endeavour</td>
<td>Ida (pre)</td>
<td>No</td>
<td>Y = E</td>
</tr>
<tr class="even">
<td>Endeavour</td>
<td>Regreso (post)</td>
<td>No</td>
<td>Y = E + t</td>
</tr>
</tbody>
</table>
<p>La idea ahora es usar las diferencias de cada barco en el tiempo, y luego restar esas diferencias entre s√≠.</p>
<p>Vamos a ponerlo en una tabla para ver si es mas claro</p>
<table class="table">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>Barco</th>
<th>Viaje (<em>t</em>)</th>
<th>Tratamiento (N)</th>
<th>Casos</th>
<th>Diferencias pre-post</th>
<th>Diferencias de las diferencias</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Marigold</td>
<td>Ida (pre)</td>
<td>No</td>
<td><strong>Y</strong> = M</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Marigold</td>
<td>Regreso (post)</td>
<td>S√≠</td>
<td><strong>Y</strong> = M + <strong>D</strong> + <em>t</em></td>
<td><em>t</em>+<strong>D</strong></td>
<td></td>
</tr>
<tr class="odd">
<td>Endeavour</td>
<td>Ida (pre)</td>
<td>No</td>
<td><strong>Y</strong> = E</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Endeavour</td>
<td>Regreso (post)</td>
<td>No</td>
<td><strong>Y</strong> = E + <em>t</em></td>
<td><em>t</em></td>
<td><strong>D</strong></td>
</tr>
</tbody>
</table>
<p>Es decir:</p>
<p><span class="math display">\[
\text{DiD} = \left( Y_{\text{Marigold}}^{\text{post}} - Y_{\text{Marigold}}^{\text{pre}} \right) - \left( Y_{\text{Endeavour}}^{\text{post}} - Y_{\text{Endeavour}}^{\text{pre}} \right)
\]</span></p>
<p>Reemplazando con las expresiones de la tabla:</p>
<p><span class="math display">\[
\text{DiD} = \left( M + D + t - M \right) - \left( E + t - E \right) = D
\]</span></p>
<p>¬°Y ah√≠ lo ten√©s! El efecto del tratamiento queda aislado: el efecto del barco se elimina porque comparamos cada barco consigo mismo, y el efecto del tiempo se elimina porque est√° presente en ambos barcos y se cancela en la resta.</p>
<p>El dise√±o de diferencia en diferencias (DiD) es una herramienta poderosa, pero no funciona por arte de magia. Para que nos d√© una estimaci√≥n v√°lida del efecto del tratamiento, hay un <strong>supuesto fundamental</strong> que debemos aceptar ‚Äîy que, de hecho, ya estaba impl√≠cito en la tabla que vimos m√°s arriba.</p>
<p>¬øQu√© estamos asumiendo sin decirlo? Que <strong>no existen factores no observados que var√≠en en el tiempo y que sean espec√≠ficos de cada unidad</strong> (en nuestro caso, cada barco). Es decir, que no hay nada especial que le pase solo al <em>Marigold</em> en el viaje de regreso, adem√°s del tratamiento, que est√© afectando la cantidad de casos de escorbuto.</p>
<p>O, formulado de otra manera: estamos asumiendo que <strong>el cambio en el tiempo ser√≠a el mismo en ambos barcos si ninguno hubiese recibido tratamiento</strong>.</p>
<p>Este supuesto se conoce como el de <strong>tendencias paralelas</strong> (<em>parallel trends assumption</em>), y lo podemos expresar en notaci√≥n as√≠:</p>
<p><span class="math display">\[
\delta_t^{\text{Marigold}} = \delta_t^{\text{Endeavour}}
\]</span></p>
<p>Este <span class="math inline">\(\delta_t\)</span> representa el cambio natural que ocurre entre el viaje de ida y el de regreso (por ejemplo, por una ola de escorbuto que afecta a todos por igual). Si esa tendencia es paralela entre unidades tratadas y no tratadas, entonces podemos confiar en que la diferencia adicional observada en el <em>Marigold</em> se debe realmente al tratamiento ‚Äîy no a alg√∫n otro cambio no observado.</p>
<blockquote class="blockquote">
<p>Volveremos una y otra vez a este supuesto a lo largo del cap√≠tulo, porque es el coraz√≥n del motor que hace andar este dise√±o.</p>
</blockquote>
<p>Cuando este supuesto se cumple, <strong>DiD nos permite identificar el efecto causal del tratamiento</strong>, incluso sin asignaci√≥n aleatoria. Y lo hace de forma sorprendentemente simple: usando observaciones repetidas en unidades tratadas y no tratadas (como los viajes de ida y vuelta de ambos barcos), eliminamos tanto la heterogeneidad entre unidades como los cambios compartidos en el tiempo. Una vez definido el escenario b√°sico nos vamos a poner a hablar formalmente de este tipo de dise√±o.</p>
<blockquote class="blockquote">
<p>Es posible que llegado este punto esten preocupados por el escorbuto, no se preocupen la vitamina C que tienen los mates que tomaron leyendo esto es m√°s que suficiente para evitarlo, pero por las dudas‚Ä¶vamos a seguir leyendo ‚Ä¶</p>
<p><img src="images/pepe_mate.jpg" class="img-fluid" width="458"></p>
</blockquote>
</section>
</section>
<section id="definicion-formal-de-diferencias-en-diferencias" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="definicion-formal-de-diferencias-en-diferencias"><span class="header-section-number">7.3</span> Definicion formal de Diferencias en diferencias</h2>
<p>El caso que hemos presentado es el caso mas sencillo de dise√±o DD que se suele llamar <strong>DD2x2</strong>. Este dise√±o incluye un <strong>grupo tratado</strong> y un <strong>grupo no tratado</strong>. Hay un <strong>per√≠odo previo</strong> para el grupo tratado (<code>pre(k)</code>), un <strong>per√≠odo posterior</strong> para el grupo tratado (<code>post(k)</code>), un <strong>per√≠odo previo</strong> para el grupo no tratado (<code>pre(U)</code>) y un <strong>per√≠odo posterior</strong> para el grupo no tratado (<code>post(U)</code>). Entonces:</p>
<p><span class="math display">\[
\hat{\delta}^{\text{2x2}}_{\text{kU}} = (\bar{Y}_{k_\text{post}} - \bar{Y}_{k_\text{pre}}) - (\bar{Y}_{U_\text{post}} - \bar{Y}_{U_\text{pre}})
\]</span></p>
<p>donde:</p>
<ul>
<li><span class="math inline">\(\hat{\delta}^{\text{2x2}}_{\text{kU}}\)</span> es la estimaci√≥n del efecto promedio del tratamiento en el grupo k (el <strong>ATT</strong>)</li>
<li><span class="math inline">\(\bar{Y}\)</span> representa el promedio muestral de ese grupo particular en ese tiempo particular</li>
</ul>
<p>El primer t√©rmino, <span class="math inline">\(\bar{Y}_{k_\text{post}} - \bar{Y}_{k_\text{pre}}\)</span> es la diferencia antes-despu√©s para el grupo tratado. El segundo t√©rmino (<span class="math inline">\(\bar{Y}_{U_\text{post}} - \bar{Y}_{U_\text{pre}}\)</span>) es la misma diferencia, pero para el grupo no tratado. Luego restamos la segunda diferencia de la primera.</p>
<p>Pero esto es simplemente la <strong>mec√°nica del c√°lculo</strong>. ¬øA qu√© corresponde exactamente este par√°metro estimado? Para entender eso, debemos convertir estos promedios muestrales en <strong>valores esperados condicionales de resultados potenciales</strong>. Por suerte, eso es f√°cil de hacer cuando trabajamos con promedios, como veremos ahora.</p>
<p>Primero, reescribamos la expresi√≥n como una <strong>esperanza condicional</strong>.</p>
<p><span class="math display">\[
\hat{\delta}^{\text{2x2}}_{\text{kU}} = (E[Y_k|Post] - E[Y_k|Pre]) - (E[Y_U|Post] - E[Y_U|Pre])
\]</span></p>
<p>Luego, usamos la ecuaci√≥n de cambio (<em>switching equation</em>), que transforma observaciones hist√≥ricas en resultados potenciales. Como ya hicimos antes, vamos a hacer un peque√±o truco: <strong>sumar cero</strong> en el lado derecho para poder reorganizar los t√©rminos y destacar algo importante.</p>
<p><span class="math display">\[
\hat{\delta}^{\text{2x2}}_{\text{kU}} = \underbrace{(E[Y^1_k|post] -E[Y^0_k|pre])-(E[Y^0_U|post] -E[Y^0_U|pre])}_{\text{switching equation}} + \underbrace{(E[Y^0_k|post] -E[Y^0_k|ppost])}_{\text{suma cero}}
\]</span></p>
<p>Al reorganizar estos t√©rminos, obtenemos la descomposici√≥n de la estimaci√≥n DD en funci√≥n de <strong>valores esperados condicionales de resultados potenciales</strong>:</p>
<p><span class="math display">\[
\hat{\delta}^{\text{2x2}}_{\text{kU}} =
\underbrace{\left( E[Y^1_k \mid \text{post}] - E[Y^0_k \mid \text{post}] \right)}_{\text{ATT}} +
\underbrace{\left[ \left( E[Y^0_k \mid \text{post}] - E[Y^0_k \mid \text{pre}] \right) - \left( E[Y^0_U \mid \text{post}] - E[Y^0_U \mid \text{pre}] \right) \right]}_{\text{Bias due to non-parallel trends in 2x2}}
\]</span></p>
<p>Estudiemos ahora ese √∫ltimo t√©rmino. Este dise√±o DD sencillo <strong>aisla el ATT</strong> (primer t√©rmino) <strong>si y solo si</strong> el segundo t√©rmino se anula. ¬øPero por qu√© se anular√≠a ese segundo t√©rmino? Se anula si la <strong>primera diferencia del grupo tratado</strong> (<code>E[Y(0) | D=1, t=1] - E[Y(0) | D=1, t=0]</code>) es igual a la <strong>segunda diferencia del grupo no tratado</strong> (<code>E[Y(0) | D=0, t=1] - E[Y(0) | D=0, t=0]</code>).</p>
<p>Pero f√≠jate en el t√©rmino de la segunda l√≠nea. ¬øNotas algo extra√±o? El objeto de inter√©s es <code>E[Y(0) | D=1, t=1]</code>, es decir, el resultado en el <strong>grupo tratado</strong> en el <strong>per√≠odo posterior</strong>, pero <strong>en un mundo sin tratamiento</strong>. Seg√∫n la <em>switching equation</em>, este resultado <strong>no es observable</strong>. Y como hemos repetido varias veces: <strong>los contrafactuales no se pueden observar</strong>.</p>
<p>Esta conclusi√≥n se conoce como el <strong>supuesto de tendencias paralelas</strong> (<em>parallel trends assumption</em>), y <strong>por definici√≥n, no es contrastable</strong> emp√≠ricamente, ya que no podemos observar ese valor esperado contrafactual.</p>
<p>Volveremos sobre este tema m√°s adelante, pero por ahora, lo presentamos para que lo tengas presente.</p>
</section>
<section id="el-supuesto-de-las-tendencias-paralelas" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="el-supuesto-de-las-tendencias-paralelas"><span class="header-section-number">7.4</span> El supuesto de las tendencias paralelas</h2>
<p>Vamos a tratar de entender mejor el problema de las tendencias paralelas. Vamos para ello a utilizar el trabajo clasico de Card y Krueger (1994). Estos investigadores aprovechando que dos estados vecinos: New Jersey -NJ- que iba a fijar un cambio de su salario minimo y Pennsylvania -PA- que iba a mantenerlo tal cual, decidieron estudiar su impacto sobre el empleo. Evaluaron el numero de empleos antes y despues de la medida en ambos estados. Es decir un dise√±o 2x2DiD</p>
<p>es decir que podriamos el ATT de esta forma:</p>
<p><span class="math display">\[
\hat{\delta}^{\text{2x2}}_{\text{NJ,PA}} =
\underbrace{\left( E[Y^1_\text{NJ} \mid \text{post}] - E[Y^0_\text{NJ} \mid \text{post}] \right)}_{\text{ATT}} +
\underbrace{\left[ \left( E[Y^0_\text{NJ} \mid \text{post}] - E[Y^0_\text{NJ} \mid \text{pre}] \right) - \left( E[Y^0_\text{PA} \mid \text{post}] - E[Y^0_\text{PA} \mid \text{pre}] \right) \right]}_{\text{Bias due to non-parallel trends in 2x2}}
\]</span></p>
<p>Usando la switching equation (asumiendo que el efecto y el tiempo son fijos), podriamos estimar el efecto del salario minimo en el empleo (<span class="math inline">\(Y\)</span>) como una regresi√≥n lineal en donde:</p>
<p><span class="math display">\[
Y=\alpha+\gamma NJ_s+ \lambda D_t+\delta(NJxD)_\text{st}+ \epsilon
\]</span></p>
<p>Vamos a explicar esta f√≥rmula, aqu√≠ NJ es una variable dummy (1 si es NJ y 0 si es PA) y D es una dummy del tiempo (1 si es post y 0 si es pre). Entonces las medidas adoptarian la siguiente forma dependiendo si las dummies son 0 o no.</p>
<ul>
<li><p>PA pre = <span class="math inline">\(\alpha\)</span></p></li>
<li><p>PA post = <span class="math inline">\(\alpha +\lambda\)</span></p></li>
<li><p>NJ pre = <span class="math inline">\(\alpha + \gamma\)</span></p></li>
<li><p>NJ post= $ + ++ $</p></li>
</ul>
<p>Graficarlo visualmente ser√≠a algo as√≠:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/DiD_Mesa%20de%20trabajo%201.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>Si miramos cuidadosamente el parametro <span class="math inline">\(\delta\)</span> podemos ver como no es otro m√°s que el ATT ya que es la distancia entre el valor que adopta NJ en el post tratamiento (en la linea solida) con respecto al valor contrafactico que hubiera adoptado sin tratamiento (la linea punteada) ya que si volvemos a nuestra ecuacion esto ser√≠a asi:</p>
<p>$$</p>
<p>= E[Y^1_ ] - E[Y^0_]</p>
<p>$$ Donde el primer termino es observado (porque <span class="math inline">\(Y=Y^1\)</span>, es decir la medida post tratamiento de NJ que recibio el tratamiento) y el segundo termino no por la misma razon</p>
<p>Ahora viene lo importante, una regresi√≥n lineal escrita a partir del dise√±o 2x2DiD siempre estimar√° la l√≠nea punteada, incluso si la pendiente contrafactual hubiera sido otra. Esto ocurre porque la regresion lineal utiliza el cambio en el tiempo de Pensilvania para proyectar un punto a partir del valor previo al tratamiento de Nueva Jersey. Una vez que se ha llenado ese valor faltante, el estimador del par√°metro es igual a la diferencia entre el valor observado tras el tratamiento y el valor proyectado, calculado seg√∫n la pendiente de Pensilvania, sin importar si esa pendiente de Pensilvania era o no el referente correcto para medir la pendiente contrafactual de Nueva Jersey. En resumen, esta regresi√≥n siempre estima un tama√±o de efecto usando la pendiente del grupo no tratado como contrafactual, sin importar si esa pendiente es realmente la adecuada.</p>
<p>Pero, si la pendiente de Pensilvania es igual a la pendiente contrafactual de Nueva Jersey: en ese caso, la pendiente de Pensilvania utilizada en la regresi√≥n estimar√° mec√°nicamente el ATT.</p>
<p>Ahora como venimos viendo, este analisis asume que la pendiente del contrafactico del grupo tratamiento es paralela a la pendiente del grupo control. Si esto no ocurriera exactamente as√≠ el escenario ser√≠a este.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/DiD-02.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>En la figura vemos entonces que la regresi√≥n estimo un punto contrafactico basado en la pendiente de PA (el grupo control), que podemos ver en azul en ese caso lo cual un estima un parametro <span class="math inline">\(\hat{\delta}^\text{RL}\)</span> que es distinto del verdadero efecto causal dado por el estimador del ATT (nuestro parametro <span class="math inline">\(\hat{\delta}^\text{ATT}\)</span>) que es la distancia entre la observacion de NJ y el contractico real de NJ si no hubiera recibido el tratamiento.</p>
<p>Aqu√≠ vemos la importancia del <strong>supuesto de tendencias paralelas</strong>. La √∫nica situaci√≥n en la que la estimaci√≥n de la regresi√≥n es igual al ATT es cuando el contrafactual de Nueva Jersey coincide por casualidad con la l√≠nea punteada de la regresi√≥n, que es una l√≠nea paralela a la pendiente de Pensilvania. Y aqu√≠ es donde surge el escepticismo comprensible de muchos observadores: ¬øpor qu√© deber√≠amos basar la estimaci√≥n en esta creencia en una coincidencia? Al fin y al cabo, estamos hablando de una tendencia contrafactual, y por lo tanto no observable, dado que nunca ocurri√≥. Tal vez el contrafactual habr√≠a seguido la l√≠nea de la regresi√≥n, o tal vez habr√≠a sido alguna otra l√≠nea desconocida. Podr√≠a haber sido cualquier cosa ‚Äîsimplemente no lo sabemos.</p>
<p>Por eso se puede decir que el <strong>supuesto de tendencias paralelas</strong> es, en realidad, simplemente otra forma de expresar el <strong>supuesto de exogeneidad estricta</strong></p>
<div class="callout callout callout-style-simple no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>El supuesto de exogeneidad estricta establece que los errorers (o t√©rminos no observados) del modelo no est√°n correlacionados con las variables explicativas (regresores), y en el caso especial de las DiD, en ning√∫n per√≠odo de tiempo.</p>
</div>
</div>
</div>
<p>Al decidir optar por un dise√±o DiD debemos asumir esta condici√≥n, porque no tenemos forma de deducir cuanto esta de lejos un contrafactual (el que determina la regresi√≥n) del contrafactico real. Basicamente porque ambos son conrafacticos y no medibles. Lo que decimos al apelar a las tendencias paralelas es que hemos encontrado un grupo de control que aproxima la trayectoria que habr√≠a seguido el grupo tratado, y que el tratamiento no es end√≥geno (es decir que el tratamiento no es producto de las condiciones internas del grupo). Si el tratamiento es end√≥geno, entonces las tendencias paralelas se violan siempre, porque en el contrafactual el grupo tratado habr√≠a divergido de todos modos, independientemente del tratamiento.</p>
<p>Como dijimos esta situacion es inmedible, es una asuncion, es decir necesita un <em>salto de fe</em> y creer que la pendiente del grupo control es igual (o muy aproximada) a la pendiente del grupo tratamiento si no hubiera recibido el tratamiento (el contrafactico real). Pero como todo salto de fe, bueno este puede tener un poco o nada de evidencia a su favor. Veamos como podemos abordar este problema</p>
<section id="evidencia-a-favor-del-supuesto-de-pendientes-paralelas" class="level3" data-number="7.4.1">
<h3 data-number="7.4.1" class="anchored" data-anchor-id="evidencia-a-favor-del-supuesto-de-pendientes-paralelas"><span class="header-section-number">7.4.1</span> Evidencia a favor del supuesto de pendientes paralelas</h3>
<p>Dada la importancia cr√≠tica del supuesto de tendencias paralelas para identificar efectos causales con el dise√±o de diferencias en diferencias (DiD), y dado que una de las observaciones necesarias para evaluar dicho supuesto no est√° disponible para el investigador, uno podr√≠a rendirse y tirar la toalla. Sin embargo hay un par de metodos para <em>agregar evidencia razonable</em> acerca del supuesto. Vamos a ver dos:</p>
<ul>
<li><p>Estudio de eventos</p></li>
<li><p>Chequeo del balance pretratamiento entre grupos</p></li>
</ul>
<section id="estudio-de-eventos-previos" class="level4" data-number="7.4.1.1">
<h4 data-number="7.4.1.1" class="anchored" data-anchor-id="estudio-de-eventos-previos"><span class="header-section-number">7.4.1.1</span> Estudio de eventos previos</h4>
<p>Volvamos a rescribirla formula de nuestro dise√±o</p>
<p><span class="math display">\[
\hat{\delta}^{\text{2x2}}_{\text{kU}} =
\underbrace{\left( E[Y^1_k \mid \text{post}] - E[Y^0_k \mid \text{post}] \right)}_{\text{ATT}} +
\underbrace{\left[ \left( E[Y^0_k \mid \text{post}] - E[Y^0_k \mid \text{pre}] \right) - \left( E[Y^0_U \mid \text{post}] - E[Y^0_U \mid \text{pre}] \right) \right]}_{\text{Bias due to non-parallel trends in 2x2}}
\]</span></p>
<p>Nos interesa el primer t√©rmino, el ATT, pero este se ve contaminado por sesgo de selecci√≥n cuando el segundo t√©rmino no es igual a cero. Como evaluar el segundo t√©rmino requiere el contrafactual, $ E[Y0‚à£post,D=1]‚àíE[Y0‚à£pre,D=1]E[Y0‚à£post,D=1]‚àíE[Y0‚à£pre,D=1]$, no podemos hacerlo directamente. Lo que que si se puede hacer, en cambio, es comparar coeficientes placebo de DD en los per√≠odos previos al tratamiento. Si los coeficientes DD en esos per√≠odos pretratamiento son estad√≠sticamente iguales a cero, entonces las diferencias en diferencias entre el grupo tratado y el de control siguieron una tendencia similar antes del tratamiento.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imgs/DiD-04.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>Y aqu√≠ aparece el arte ret√≥rico del dise√±o: si fueron similares antes, ¬øpor qu√© no habr√≠an de continuar si√©ndolo despu√©s del tratamiento?</p>
<p>Pero esta ret√≥rica es una especie de prueba por afirmaci√≥n. Que hayan sido similares antes no implica l√≥gicamente que deban serlo despu√©s. Asumir que el futuro ser√° como el pasado es una forma de la falacia del jugador conocida como la ‚Äúposici√≥n inversa‚Äù. Que una moneda haya salido cara tres veces seguidas no significa que deba salir cara la cuarta vez, al menos no sin otros supuestos adicionales. De la misma forma, no estamos obligados a creer que las tendencias contrafactuales ser√≠an iguales tras el tratamiento solo porque lo fueron antes, salvo que hagamos m√°s supuestos sobre el poder predictivo de las tendencias previas. Pero hacer tales supuestos es, nuevamente, hacer supuestos no comprobables, y as√≠ volvemos al punto de partida.</p>
<p>Un caso en el que las tendencias paralelas se violar√≠an de forma evidente es cuando el tratamiento es end√≥geno. En ese escenario, la asignaci√≥n al tratamiento depender√≠a directamente de los resultados potenciales y, en ausencia del tratamiento, esos resultados habr√≠an cambiado de todas formas. Tal endogeneidad tradicional requiere m√°s que simples visualizaciones ‚Äúperezosas‚Äù de las tendencias previas. Aunque la prueba de placebo es importante, t√©cnicamente las similitudes pretratamiento no son necesarias ni suficientes para garantizar tendencias contrafactuales paralelas (Kahn-Lang y Lang 2019). El supuesto no se prueba tan f√°cilmente. Nunca se puede dejar de ser riguroso al intentar determinar si los grupos se seleccionaron end√≥genamente al tratamiento, si hay sesgos por variables omitidas, distintas fuentes de sesgo de selecci√≥n o caminos de retroceso abiertos. Cuando el t√©rmino de error estructural en un modelo de regresi√≥n din√°mica no est√° correlacionado con la variable de tratamiento, se tiene exogeneidad estricta, y eso es lo que proporciona las tendencias paralelas y permite hacer afirmaciones significativas sobre las estimaciones.</p>
</section>
<section id="mostrar-el-balance-pretratamiento-de-ambos-grupos" class="level4" data-number="7.4.1.2">
<h4 data-number="7.4.1.2" class="anchored" data-anchor-id="mostrar-el-balance-pretratamiento-de-ambos-grupos"><span class="header-section-number">7.4.1.2</span> Mostrar el balance pretratamiento de ambos grupos</h4>
<p>Recien mencionamos que estudiar los eventos previos es una forma (indirecta) de juntar evidencia a favor de este supuesto de tendencias paralelas (para que el salto de fe no sea tan alto) El problema es que como analizamos eso?, bueno hay varios enfoques que podemos tomar, en conjunto se los suele llamar <em>event study plots</em> Una forma simple de conducir esto es graficar los datos pretratamiento (como en en la figura anterior), sin embargo esto requiere que tengamos mucha suerte y los datos se hayan tomado en forma fija en otros eventos. Estos datos que provienen de observaicones rara vez suelen comportarse asi</p>
<p>Un escenario mucho m√°s com√∫n es la existencia de un <em>timing diferencial</em>, en el que los grupos de unidades adoptan el tratamiento en distintos momentos. Entonces el concepto de ‚Äúpretratamiento‚Äù se vuelve complejo. En nuestro ejemplo para el caso, Nueva Jersey aument√≥ su salario m√≠nimo en 1992 y Nueva York lo hizo en 1994, pero Pensilvania nunca aument√≥ su salario m√≠nimo, el per√≠odo previo al tratamiento se define para Nueva Jersey (1991) y para Nueva York (1993), pero no para Pensilvania. Entonces, ¬øc√≥mo probamos las diferencias previas al tratamiento en ese caso? La gente lo ha hecho de varias maneras.</p>
<p>Una posibilidad es graficar los datos brutos, a√±o por a√±o, y simplemente observar a ojo. Comparar√≠as el grupo tratado con el nunca tratado, por ejemplo, lo que podr√≠a requerir muchos gr√°ficos y ser visualmente inc√≥modo.La ventaja es que muestra de forma transparente los datos crudos sin ajustes. Sin trucos. Las desventajas son varias. Primero, puede ser engorroso cuando el n√∫mero de grupos tratados es grande, volvi√©ndolo pr√°cticamente imposible. Segundo, puede que no sea visualmente atractivo. Y tercero, este enfoque asume necesariamente que el √∫nico grupo de control es el nunca tratado, lo que en realidad no es cierto. Cualquier DiD es una combinaci√≥n de una comparaci√≥n entre tratados y nunca tratados, tratados tempranos (a los que llamaremos <strong>leads</strong>) frente a tratados tard√≠os (a los que llamaremos <strong>lags</strong>) y tratados tard√≠os frente a tratados tempranos. Por lo tanto, mostrar solo la comparaci√≥n con los nunca tratados es en realidad una presentaci√≥n enga√±osa del mecanismo de identificaci√≥n subyacente en un modelo de efectos fijos bidireccionales con timing diferencial.</p>
<p>La forma actual en que se eval√∫an las din√°micas previas al tratamiento entre un grupo tratado y uno de control con timing diferencial es estimar un modelo de regresi√≥n que incluya <em>leads</em> y <em>lags</em> del tratamiento. Un ejemplo de eso puede ser graficar los leads previos al tratamiento en lugar de graficar tratamiento y control y tras la estimacion graficar los intervalos de regresion en cada unidad de leads/lags. Los modelos como estos suelen seguir una forma asi:</p>
<p><span class="math display">\[
Y_{its} = \gamma_s + \lambda_t + \sum_{\tau=-q}^{-1} \gamma_{\tau} D_{s\tau} + \sum_{\tau=0}^{m} \delta_{\tau} D_{s\tau} + x_{ist} + \varepsilon_{ist}
\]</span> El tratamiento ocurre en el a√±o 0. Se incluyen <span class="math inline">\(q\)</span> leads o efectos anticipatorios, y <span class="math inline">\(m\)</span> lags o efectos posteriores al tratamiento. Ete tipo de enfoques permite al al lector comprobar tanto el grado en que los efectos del tratamiento post-tratamiento fueron din√°micos, como si los dos grupos eran comparables en sus din√°micas del resultado antes del tratamiento.</p>
</section>
</section>
</section>
<section id="la-importancia-delplacebo" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="la-importancia-delplacebo"><span class="header-section-number">7.5</span> La importancia delplacebo</h2>
<p>Existen varias pruebas para evaluar la validez de una estrategia de difference-in-differences (DD). Ya he mencionado una: la comparabilidad entre los grupos de tratamiento y control en las din√°micas observables antes del tratamiento. Ahora hablar√© de otras formas cre√≠bles de evaluar si los efectos causales estimados son fiables, destacando el uso de falsificaci√≥n mediante placebos.</p>
<p>La idea de la falsificaci√≥n con placebos es sencilla. Supongamos que encuentras un efecto negativo del salario m√≠nimo sobre el empleo de los trabajadores con salarios bajos. ¬øEs verdadera la hip√≥tesis si encontramos evidencia a favor? Quiz√°s s√≠, quiz√°s no. Lo que realmente podr√≠a ayudar ser√≠a tener en mente una hip√≥tesis alternativa e intentar ponerla a prueba. Si no puedes rechazar la hip√≥tesis nula en esa hip√≥tesis alternativa, eso aporta credibilidad a tu an√°lisis original. Por ejemplo, puede que est√©s captando algo espurio, como factores c√≠clicos u otros no observables que no se capturan f√°cilmente con efectos fijos de tiempo o de estado. Entonces, ¬øqu√© puedes hacer?</p>
<p>Un candidato para la falsificaci√≥n con placebo podr√≠a ser simplemente usar datos de un tipo alternativo de trabajador cuyos salarios no se vean afectados por el salario m√≠nimo vinculante. Por ejemplo, los salarios m√≠nimos afectan el empleo y las ganancias de los trabajadores con salarios bajos, ya que estos son los trabajadores contratados literalmente con base en el salario de mercado. Sin un serio equilibrio general de por medio, el salario m√≠nimo no deber√≠a afectar el empleo de los trabajadores con salarios altos, porque el salario m√≠nimo no es vinculante para ellos. Dado que los trabajadores de salarios altos y bajos suelen estar empleados en sectores muy distintos, es poco probable que sean sustitutos. Este razonamiento podr√≠a llevarnos a considerar que los trabajadores con salarios altos funcionen como un placebo.</p>
<p>Hay dos formas de incorporar esta idea en nuestro an√°lisis. A muchos les gusta ser directos y simplemente ajustar el mismo dise√±o DD usando como variable de resultado el empleo de los trabajadores con salarios altos. Si el coeficiente del salario m√≠nimo es cero cuando usamos el empleo de trabajadores con salarios altos como resultado, pero el coeficiente del salario m√≠nimo para los trabajadores con salarios bajos es negativo, entonces habremos aportado una evidencia m√°s s√≥lida que complementa el an√°lisis previo de los trabajadores con salarios bajos. Pero hay otro m√©todo que utiliza el placebo dentro del estado para la identificaci√≥n, llamado difference-in-differences-in-differences (o ‚Äútriple differences‚Äù), que no abordaremos aqui</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiada");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./matching.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Subclasificaci√≥n y <em>matching</em></span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./reg_discontinua.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Regresi√≥n discontinua</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Dise√±os experimentales y cuasiexperimentales - Ignacio Spiousas.</div>   
    <div class="nav-footer-right">Este libro fue creado con <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>